<div class="autocomplete-text-field-control custom-control">
  <label class="label" *ngIf="controlLabel" [for]="controlId">
    <span>{{ controlLabel }}</span>
  </label>

  <!-- TODO: Initial value? -->
  <!-- Disabled? -->
  <input
    #inputRef
    class="control"
    [id]="controlId"
    [matAutocomplete]="matAutocompleteRef"
    [formControl]="inputControl"
    (focus)="handleControlFocus()"
    (blur)="handleControlBlur()"
  />

  <ng-container *ngTemplateOutlet="locationIconSvg"></ng-container>

  <mat-autocomplete
    #matAutocompleteRef="matAutocomplete"
    (optionSelected)="handleOptionSelection($event)"
  >
    <mat-option
      *ngFor="let option of filteredOptions$ | async"
      [value]="option.label"
    >
      <div class="option-content">
        <div
          class="option-content__text"
          *ngIf="option.label | destructureLocationLabel as location"
        >
          <div class="option-content__city">
            <span>{{ location.cityName }}</span>
          </div>

          <div class="option-content__country">
            <span>{{ location.countryName }}</span>
          </div>
        </div>

        <div class="option-content__icon">
          <ng-container *ngTemplateOutlet="arrowRightIconSvg"></ng-container>
        </div>
      </div>
    </mat-option>
  </mat-autocomplete>
</div>

<ng-template #locationIconSvg>
  <svg
    class="location-icon"
    [class.location-icon--primary-colored]="isFocused"
    width="11"
    height="15.7"
    viewBox="0 0 14 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M7 9.5C6.33696 9.5 5.70107 9.23661 5.23223 8.76777C4.76339 8.29893 4.5 7.66304 4.5 7C4.5 6.33696 4.76339 5.70107 5.23223 5.23223C5.70107 4.76339 6.33696 4.5 7 4.5C7.66304 4.5 8.29893 4.76339 8.76777 5.23223C9.23661 5.70107 9.5 6.33696 9.5 7C9.5 7.3283 9.43534 7.65339 9.3097 7.95671C9.18406 8.26002 8.99991 8.53562 8.76777 8.76777C8.53562 8.99991 8.26002 9.18406 7.95671 9.3097C7.65339 9.43534 7.3283 9.5 7 9.5ZM7 0C5.14348 0 3.36301 0.737498 2.05025 2.05025C0.737498 3.36301 0 5.14348 0 7C0 12.25 7 20 7 20C7 20 14 12.25 14 7C14 5.14348 13.2625 3.36301 11.9497 2.05025C10.637 0.737498 8.85652 0 7 0Z"
      fill="#B1B1B1"
    />
  </svg>
</ng-template>

<ng-template #arrowRightIconSvg>
  <svg
    width="6"
    height="11"
    viewBox="0 0 6 11"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path d="M1 10.5L5 5.37179L1 0.5" stroke="#000000" stroke-linecap="round" />
  </svg>
</ng-template>
